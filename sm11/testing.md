# Тестирование функциональности

## Интеграционный тест: передача невалидного `QR`-кода

Описание теста: при сканировании `QR`-кода с чека делается запрос к открытому `API` ФНС России.

1. Перейти в режим сканирования `QR`-кода с чека
2. Передать в `endpoint` невалидный `QR`-код
3. Проверяем был ли запрос к `API` с помощью `debug` `endpoint`

В случае передачи невалидного `QR`-кода клиент должен получить `Bad Request 400`. Также ожидаемое поведение - отсутствие запроса к `API`, в случае передачи невалидного `QR`-кода

## E2e тест

Описание теста: end to end тестирование всего приложения

1. Просканировать тестовый чек
   1. Перейти в режим сканирования
   2. Подложить QR код тестового чека
   3. Проверить, что продукты появились и отображаются в холодильнике
2. Запустить поиск рецепта на основе добавленных продуктов
   1. Выбрать рецепт, проверить, что все необходимые продукты и их граммовки действительно в наличии
3. Изменить вручную граммовку продукта из холодильника
4. Добавить вручную продукт с исходящим сроком годности
   1. Перейти в режим добавления
   2. Добавить и проверить, что появился в холодильнике
   3. Проверить, что приходит уведомление об истечении срока годности
5. Проверка удаления продуктов из холодильника

## Тест отказоустойчивости

Описание теста: Проверка того, что при сбое на стороне ФНС России наше приложение продолжает функционировать, теряя только возможность добавлять новые продукты.

1. Перейти в режим сканирования `QR`-кода
2. Подменить API ФНС, чтобы оно всегда возвращало 500/таймаутило.
3. Отсканировать `QR`-код
4. Удостовериться, что появилось сообщение об ошибке.
5. Проверить остальной функционал аналогично e2e тестированию.
6. Вернуть обратно нормальное API.
7. Отсканировать `QR`-код.
8. Проверить, что продукт появился в холодильнике.
